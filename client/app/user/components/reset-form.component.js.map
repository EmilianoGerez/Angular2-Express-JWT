{"version":3,"sources":["user/components/reset-form.component.ts"],"names":[],"mappings":"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","file":"reset-form.component.js","sourcesContent":["import {Component, OnInit} from '@angular/core';\r\nimport {FormBuilder, ControlGroup, Validators, FORM_DIRECTIVES} from '@angular/common';\r\nimport {ROUTER_DIRECTIVES, RouteParams} from '@angular/router-deprecated';\r\nimport {AuthService} from \"../services/auth.service\";\r\nimport {UserValidators} from \"../classes/user.validators\";\r\n\r\n@Component({\r\n  selector: 'reset-form',\r\n  templateUrl: './app/user/templates/reset-form.template.html',\r\n  directives: [FORM_DIRECTIVES, ROUTER_DIRECTIVES],\r\n  providers: [AuthService]\r\n})\r\n\r\nexport class ResetFormComponent {\r\n  resetForm:ControlGroup;\r\n  isReset:boolean = false;\r\n  errorMsg:any;\r\n  sending:boolean = false;\r\n  disabledInput:boolean = false;\r\n  codeModel:string;\r\n\r\n  constructor(fb:FormBuilder,\r\n              private _authService:AuthService,\r\n              private _params:RouteParams) {\r\n\r\n    this.resetForm = fb.group({\r\n      code: ['', Validators.required],\r\n      password: ['', Validators.compose([\r\n        Validators.required,\r\n        Validators.minLength(8),\r\n        Validators.maxLength(15)\r\n      ])],\r\n      repassword: ['', Validators.required]\r\n    }, {validator: UserValidators.passwordMatch});\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    let code = this._params.get('code');\r\n\r\n    if (!code || code === 'null') {\r\n      return;\r\n    }\r\n    this.disabledInput = true;\r\n    this.codeModel = code;\r\n  }\r\n\r\n  onSubmit(formValue:any) {\r\n    this.errorMsg = false;\r\n    this.sending = true;\r\n    this._authService.resetPassword(formValue)\r\n      .subscribe(\r\n        res => {\r\n          this.isReset = true;\r\n          this.sending = false;\r\n        },\r\n        err => {\r\n          this.sending = false;\r\n          this.setError(err);\r\n        });\r\n  }\r\n\r\n  private setError(err:any) {\r\n    let errResponse = err.json();\r\n    console.log(err);\r\n\r\n    switch (errResponse.error) {\r\n      case 'invalidCode':\r\n        this.errorMsg = {\r\n          head: 'Invalid Code!!',\r\n          msg: 'please verify your input code.'\r\n        };\r\n        break;\r\n      case 'expiredCode':\r\n        this.errorMsg = {\r\n          head: 'Expired Code!!',\r\n          msg: 'please send a new activation email'\r\n        };\r\n        break;\r\n      default:\r\n        this.errorMsg = {\r\n          head: 'Oops!!',\r\n          msg: 'something went wrong.'\r\n        };\r\n    }\r\n  }\r\n}\r\n"]}